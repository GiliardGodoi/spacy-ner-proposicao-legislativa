convert:
  cmd: python -m weasel run convert
  script:
    - python scripts/convert.py pt assets/admin.jsonl corpus
  deps:
    - path: assets/admin.jsonl
      md5: 851b6885242aa604681c1360bb3bf2cf
    - path: scripts/convert.py
      md5: 76130e75483b1ac360b79a0b4c05fd34
  outs:
    - path: corpus/train.spacy
      md5: 05b973ea9ce50274abe0f8c22763fb76
    - path: corpus/dev.spacy
      md5: 4fa602ea7154f85e10f8af68a4b9b90a
create-config:
  cmd: python -m weasel run create-config
  script:
    - python scripts/create_config.py pt_core_news_lg ner configs/config.cfg
  deps:
    - path: scripts/create_config.py
      md5: dc8478cb043c4803dd141565fd34f0f5
  outs:
    - path: configs/config.cfg
      md5: 87c7e4a52892bb88d30650a340562fc2
train:
  cmd: python -m weasel run train
  script:
    - python -m spacy train configs/config.cfg --output training/ --paths.train corpus/train.spacy
      --paths.dev corpus/dev.spacy --training.eval_frequency 10 --training.max_steps
      1000 --gpu-id -1
  deps:
    - path: configs/config.cfg
      md5: 87c7e4a52892bb88d30650a340562fc2
    - path: corpus/train.spacy
      md5: 05b973ea9ce50274abe0f8c22763fb76
    - path: corpus/dev.spacy
      md5: 4fa602ea7154f85e10f8af68a4b9b90a
  outs:
    - path: training/model-best
      md5: be3d736989c33cd285ed278a923c9a52
evaluate:
  cmd: python -m weasel run evaluate
  script:
    - python -m spacy evaluate training/model-best corpus/dev.spacy --output training/metrics.json
  deps:
    - path: corpus/dev.spacy
      md5: 4fa602ea7154f85e10f8af68a4b9b90a
    - path: training/model-best
      md5: be3d736989c33cd285ed278a923c9a52
  outs:
    - path: training/metrics.json
      md5: 67541750330f3bb01190db9478bf1a74
package:
  cmd: python -m weasel run package
  script:
    - python -m spacy package training/model-best packages --name csap_ner --version
      0.0.1 --force
  deps:
    - path: training/model-best
      md5: 6db9d20d951ec1e656d8b52700e7b603
  outs: []
